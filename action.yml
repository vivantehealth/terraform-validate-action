name: 'Terraform Validate'
description: "terraform fmt, init, and validate"
runs:
  using: "composite"
  steps:
    - name: Checkout
      uses: actions/checkout@master
    - name: Set up Terraform cli
      uses: hashicorp/setup-terraform@v1
      with:
        terraform_version: 1.0.0
    - name: Terraform fmt
      run: |
        set +e
        terraform fmt -check
        if [[ $? -ne 0 ]]; then
          echo "Be sure to run 'terraform fmt' before committing. This can usually be done in your IDE of choice"
          exit 1
        fi
        set -e
    - name: TF init
      run: terraform init -input=false -backend=false
    - name: TF validate
      run: terraform validate
